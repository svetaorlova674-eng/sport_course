<?php
// check_admin.php — Скрипт защиты (Middleware)

// 1. Включаем доступ к сессии
session_start();

// 2. Проверяем два условия:
//    А. Пользователь вообще вошел? (есть ли user_id)
//    Б. Его роль — это 'admin'?
if (!isset($_SESSION['user_id']) || $_SESSION['user_role'] !== 'admin') {
    
    // Если условия не выполнены — останавливаем работу жестко
    // Можно сделать красивее (редирект), но для безопасности надежнее так:
    die("ДОСТУП ЗАПРЕЩЕН. У вас нет прав администратора. <a href='login.php'>Войти</a>");
}

// Если код идет дальше — значит, это Админ.
?>